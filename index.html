<!DOCTYPE html>
<html lang=en-us>

<head>
    <meta charset=utf-8>
    <meta content="text/html; charset=utf-8" http-equiv=Content-Type>
    <title>OCCT Draw Harness</title>
</head>

<body>

<canvas id=occViewerCanvas oncontextmenu=event.preventDefault() tabindex=-1
        style="border:0 none;background-color:#000" width="409" height="409"></canvas>

<hr>
<textarea id="commandToRun">pload all</textarea>
<button id="runCommand">run</button>
<hr>
Results:
<textarea id="commandExecutionResults"></textarea>
<hr>
Errors:
<textarea id="commandExecutionErrors"></textarea>
<hr>

<script type="text/javascript" src="drawInterface.js" charset="utf-8"></script>

<script>
    const commandToRunTextarea = document.getElementById("commandToRun");
    const commandExecutionResultsTextarea = document.getElementById("commandExecutionResults");
    const commandExecutionErrorsTextarea = document.getElementById("commandExecutionErrors");
    const runBtn = document.getElementById("runCommand");

    createDRAWEXE().then((theModule) => {
        runBtn.addEventListener("click", function (e) {
            e.preventDefault();
            executeTCL(commandToRunTextarea.value)
        })

        function executeTCL(command) {
            command.split("\n").forEach(
                commandPart => {
                    DRAWEXE.termEvaluateCommand(commandPart)
                        .then(result => {
                            if (result) {
                                if (result.result) {
                                    commandExecutionResultsTextarea.value = commandExecutionResultsTextarea.value + "\n" + result.result;
                                }
                                if (result.errors) {
                                    commandExecutionErrorsTextarea.value = commandExecutionErrorsTextarea.value + "\n" + result.errors;
                                }
                            }
                        })
                }
            )
        }

    });

</script>

</body>

</html>